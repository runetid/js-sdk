!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(self,(()=>(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{authProviderCallback:()=>i,authUserByToken:()=>s});class r{constructor(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){const t=r.hexChars,n=r.hexOut;let s,i,a,o;for(o=0;o<4;o+=1)for(i=8*o,s=e[o],a=0;a<8;a+=2)n[i+1+a]=t.charAt(15&s),s>>>=4,n[i+0+a]=t.charAt(15&s),s>>>=4;return n.join("")}static _md5cycle(e,t){let r=e[0],n=e[1],s=e[2],i=e[3];r+=(n&s|~n&i)+t[0]-680876936|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&s)+t[1]-389564586|0,i=(i<<12|i>>>20)+r|0,s+=(i&r|~i&n)+t[2]+606105819|0,s=(s<<17|s>>>15)+i|0,n+=(s&i|~s&r)+t[3]-1044525330|0,n=(n<<22|n>>>10)+s|0,r+=(n&s|~n&i)+t[4]-176418897|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&s)+t[5]+1200080426|0,i=(i<<12|i>>>20)+r|0,s+=(i&r|~i&n)+t[6]-1473231341|0,s=(s<<17|s>>>15)+i|0,n+=(s&i|~s&r)+t[7]-45705983|0,n=(n<<22|n>>>10)+s|0,r+=(n&s|~n&i)+t[8]+1770035416|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&s)+t[9]-1958414417|0,i=(i<<12|i>>>20)+r|0,s+=(i&r|~i&n)+t[10]-42063|0,s=(s<<17|s>>>15)+i|0,n+=(s&i|~s&r)+t[11]-1990404162|0,n=(n<<22|n>>>10)+s|0,r+=(n&s|~n&i)+t[12]+1804603682|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&s)+t[13]-40341101|0,i=(i<<12|i>>>20)+r|0,s+=(i&r|~i&n)+t[14]-1502002290|0,s=(s<<17|s>>>15)+i|0,n+=(s&i|~s&r)+t[15]+1236535329|0,n=(n<<22|n>>>10)+s|0,r+=(n&i|s&~i)+t[1]-165796510|0,r=(r<<5|r>>>27)+n|0,i+=(r&s|n&~s)+t[6]-1069501632|0,i=(i<<9|i>>>23)+r|0,s+=(i&n|r&~n)+t[11]+643717713|0,s=(s<<14|s>>>18)+i|0,n+=(s&r|i&~r)+t[0]-373897302|0,n=(n<<20|n>>>12)+s|0,r+=(n&i|s&~i)+t[5]-701558691|0,r=(r<<5|r>>>27)+n|0,i+=(r&s|n&~s)+t[10]+38016083|0,i=(i<<9|i>>>23)+r|0,s+=(i&n|r&~n)+t[15]-660478335|0,s=(s<<14|s>>>18)+i|0,n+=(s&r|i&~r)+t[4]-405537848|0,n=(n<<20|n>>>12)+s|0,r+=(n&i|s&~i)+t[9]+568446438|0,r=(r<<5|r>>>27)+n|0,i+=(r&s|n&~s)+t[14]-1019803690|0,i=(i<<9|i>>>23)+r|0,s+=(i&n|r&~n)+t[3]-187363961|0,s=(s<<14|s>>>18)+i|0,n+=(s&r|i&~r)+t[8]+1163531501|0,n=(n<<20|n>>>12)+s|0,r+=(n&i|s&~i)+t[13]-1444681467|0,r=(r<<5|r>>>27)+n|0,i+=(r&s|n&~s)+t[2]-51403784|0,i=(i<<9|i>>>23)+r|0,s+=(i&n|r&~n)+t[7]+1735328473|0,s=(s<<14|s>>>18)+i|0,n+=(s&r|i&~r)+t[12]-1926607734|0,n=(n<<20|n>>>12)+s|0,r+=(n^s^i)+t[5]-378558|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^s)+t[8]-2022574463|0,i=(i<<11|i>>>21)+r|0,s+=(i^r^n)+t[11]+1839030562|0,s=(s<<16|s>>>16)+i|0,n+=(s^i^r)+t[14]-35309556|0,n=(n<<23|n>>>9)+s|0,r+=(n^s^i)+t[1]-1530992060|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^s)+t[4]+1272893353|0,i=(i<<11|i>>>21)+r|0,s+=(i^r^n)+t[7]-155497632|0,s=(s<<16|s>>>16)+i|0,n+=(s^i^r)+t[10]-1094730640|0,n=(n<<23|n>>>9)+s|0,r+=(n^s^i)+t[13]+681279174|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^s)+t[0]-358537222|0,i=(i<<11|i>>>21)+r|0,s+=(i^r^n)+t[3]-722521979|0,s=(s<<16|s>>>16)+i|0,n+=(s^i^r)+t[6]+76029189|0,n=(n<<23|n>>>9)+s|0,r+=(n^s^i)+t[9]-640364487|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^s)+t[12]-421815835|0,i=(i<<11|i>>>21)+r|0,s+=(i^r^n)+t[15]+530742520|0,s=(s<<16|s>>>16)+i|0,n+=(s^i^r)+t[2]-995338651|0,n=(n<<23|n>>>9)+s|0,r+=(s^(n|~i))+t[0]-198630844|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~s))+t[7]+1126891415|0,i=(i<<10|i>>>22)+r|0,s+=(r^(i|~n))+t[14]-1416354905|0,s=(s<<15|s>>>17)+i|0,n+=(i^(s|~r))+t[5]-57434055|0,n=(n<<21|n>>>11)+s|0,r+=(s^(n|~i))+t[12]+1700485571|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~s))+t[3]-1894986606|0,i=(i<<10|i>>>22)+r|0,s+=(r^(i|~n))+t[10]-1051523|0,s=(s<<15|s>>>17)+i|0,n+=(i^(s|~r))+t[1]-2054922799|0,n=(n<<21|n>>>11)+s|0,r+=(s^(n|~i))+t[8]+1873313359|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~s))+t[15]-30611744|0,i=(i<<10|i>>>22)+r|0,s+=(r^(i|~n))+t[6]-1560198380|0,s=(s<<15|s>>>17)+i|0,n+=(i^(s|~r))+t[13]+1309151649|0,n=(n<<21|n>>>11)+s|0,r+=(s^(n|~i))+t[4]-145523070|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~s))+t[11]-1120210379|0,i=(i<<10|i>>>22)+r|0,s+=(r^(i|~n))+t[2]+718787259|0,s=(s<<15|s>>>17)+i|0,n+=(i^(s|~r))+t[9]-343485551|0,n=(n<<21|n>>>11)+s|0,e[0]=r+e[0]|0,e[1]=n+e[1]|0,e[2]=s+e[2]|0,e[3]=i+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(r.stateIdentity),this}appendStr(e){const t=this._buffer8,n=this._buffer32;let s,i,a=this._bufferLength;for(i=0;i<e.length;i+=1){if(s=e.charCodeAt(i),s<128)t[a++]=s;else if(s<2048)t[a++]=192+(s>>>6),t[a++]=63&s|128;else if(s<55296||s>56319)t[a++]=224+(s>>>12),t[a++]=s>>>6&63|128,t[a++]=63&s|128;else{if(s=1024*(s-55296)+(e.charCodeAt(++i)-56320)+65536,s>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[a++]=240+(s>>>18),t[a++]=s>>>12&63|128,t[a++]=s>>>6&63|128,t[a++]=63&s|128}a>=64&&(this._dataLength+=64,r._md5cycle(this._state,n),a-=64,n[0]=n[16])}return this._bufferLength=a,this}appendAsciiStr(e){const t=this._buffer8,n=this._buffer32;let s,i=this._bufferLength,a=0;for(;;){for(s=Math.min(e.length-a,64-i);s--;)t[i++]=e.charCodeAt(a++);if(i<64)break;this._dataLength+=64,r._md5cycle(this._state,n),i=0}return this._bufferLength=i,this}appendByteArray(e){const t=this._buffer8,n=this._buffer32;let s,i=this._bufferLength,a=0;for(;;){for(s=Math.min(e.length-a,64-i);s--;)t[i++]=e[a++];if(i<64)break;this._dataLength+=64,r._md5cycle(this._state,n),i=0}return this._bufferLength=i,this}getState(){const e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){const t=e.buffer,r=e.state,n=this._state;let s;for(this._dataLength=e.length,this._bufferLength=e.buflen,n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],s=0;s<t.length;s+=1)this._buffer8[s]=t.charCodeAt(s)}end(e=!1){const t=this._bufferLength,n=this._buffer8,s=this._buffer32,i=1+(t>>2);this._dataLength+=t;const a=8*this._dataLength;if(n[t]=128,n[t+1]=n[t+2]=n[t+3]=0,s.set(r.buffer32Identity.subarray(i),i),t>55&&(r._md5cycle(this._state,s),s.set(r.buffer32Identity)),a<=4294967295)s[14]=a;else{const e=a.toString(16).match(/(.*?)(.{0,8})$/);if(null===e)return;const t=parseInt(e[2],16),r=parseInt(e[1],16)||0;s[14]=t,s[15]=r}return r._md5cycle(this._state,s),e?this._state:r._hex(this._state)}}if(r.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),r.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),r.hexChars="0123456789abcdef",r.hexOut=[],r.onePassHasher=new r,"5d41402abc4b2a76b9719d911017c592"!==r.hashStr("hello"))throw new Error("Md5 self test failed.");const n=function(){function e(){this.Hash="",this.Time="",this.ApiKey="peij8Ash",this.secret="Keimai3L"}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getHeaders=function(){return e.instance.Time=Date.now().toString(),e.instance.Hash=r.hashAsciiStr(e.instance.ApiKey+e.instance.Time+e.instance.secret),this},e}();function s(e,t){var r=n.getInstance().getHeaders(),s=new Request(t+"/user/byToken/"+e.token,{method:"GET",headers:new Headers({"Content-Type":"application/json",ApiKey:r.ApiKey,Hash:r.Hash,Time:r.Time})});return fetch(s).then((function(e){if(200==e.status)return e.json()})).then((function(t){localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(t))}))}var i=function(e){return{login:function(t){var r=t.username,i=t.password,a=n.getInstance().getHeaders(),o=new Request(e+"/user/login",{method:"POST",body:JSON.stringify({login:r,password:i}),headers:new Headers({"Content-Type":"application/json",ApiKey:a.ApiKey,Hash:a.Hash,Time:a.Time})});return fetch(o).then((function(e){return e.status<200||e.status>=300?Promise.reject(e.statusText):e.json()})).then((function(e){return s(e)})).catch((function(){return Promise.reject("Invalid username or password")}))},logout:function(){localStorage.removeItem("user");var t=localStorage.getItem("token");localStorage.removeItem("token");var r=n.getInstance().getHeaders(),s=new Request(e+"/user/logout/",{method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer ".concat(t),ApiKey:r.ApiKey,Hash:r.Hash,Time:r.Time})});return fetch(s),Promise.resolve()},checkError:function(){return Promise.resolve()},checkAuth:function(){return localStorage.getItem("user")?Promise.resolve():Promise.reject()},getPermissions:function(){return Promise.resolve(void 0)},getIdentity:function(){var e=localStorage.getItem("user"),t=e?JSON.parse(e):null;return Promise.resolve(t)}}};return t})()));